<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Museos de Ecuador - Mapa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Leaflet CDN -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5SXRr9lG0=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-gray-100 font-sans min-h-screen flex flex-col">
    <!-- Navbar -->
    <nav class="bg-blue-600 text-white p-4 flex justify-between items-center shadow-md">
        <h1 class="text-2xl font-bold">Museos de Ecuador</h1>
        <ul class="flex space-x-6">
            <li><a href="index.html" class="hover:underline">Home</a></li>
            <li><a href="mapa.html" class="hover:underline">Mapa</a></li>
        </ul>
    </nav>

    <!-- Sección principal -->
    <section class="p-6 md:p-8 flex-grow">
        <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">Mapa Interactivo de Museos</h2>
        
        <!-- El div del mapa con altura mínima fija para evitar bugs -->
        <div id="map" class="w-full h-[600px] md:h-[700px] border-2 border-gray-300 rounded-lg shadow-lg"></div>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Crear el mapa
            var map = L.map('map').setView([-1.8312, -78.1834], 6.5);

            // Añadir capa de OpenStreetMap
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 19
            }).addTo(map);

            // Museos
            var museums = [
                { name: 'La Capilla del Hombre', lat: -0.1915, lng: -78.4705, desc: 'Arte de Oswaldo Guayasamín - Quito' },
                { name: 'Museo de la Ciudad', lat: -0.2208, lng: -78.5125, desc: 'Historia de Quito - Centro Histórico' },
                { name: 'Casa del Alabado', lat: -0.2213, lng: -78.5158, desc: 'Arte precolombino - Quito' },
                { name: 'Museo Intiñan', lat: -0.0022, lng: -78.4558, desc: 'Línea del Ecuador - Mitad del Mundo' },
                { name: 'Museo Pumapungo', lat: -2.9061, lng: -78.9975, desc: 'Etnográfico y arqueológico - Cuenca' },
                { name: 'Panama Hat Museum', lat: -2.8974, lng: -79.0045, desc: 'Sombreros de paja toquilla - Cuenca' },
                { name: 'MAAC', lat: -2.1856, lng: -79.8761, desc: 'Arte y antropología - Guayaquil' },
                { name: 'Museo Los Amantes de Sumpa', lat: -2.2262, lng: -80.8587, desc: 'Sitio arqueológico - Santa Elena' },
                { name: 'Complejo Cultural Fábrica Imbabura', lat: 0.3325, lng: -78.2136, desc: 'Historia textil - Atuntaqui, Imbabura' },
                { name: 'Museo y Centro Cultural de Ibarra', lat: 0.3517, lng: -78.1223, desc: 'Cultura local - Ibarra, Imbabura' }
            ];

            museums.forEach(function(m) {
                L.marker([m.lat, m.lng])
                    .addTo(map)
                    .bindPopup(`<b>${m.name}</b><br>${m.desc}`);
            });

            // Forzar actualización del mapa varias veces (soluciona el bug de renderizado parcial)
            setTimeout(function() { map.invalidateSize(); }, 100);
            setTimeout(function() { map.invalidateSize(); }, 300);
            setTimeout(function() { map.invalidateSize(); }, 600);
            setTimeout(function() { map.invalidateSize(); }, 1000);

            // También actualiza si cambias el tamaño de la ventana
            window.addEventListener('resize', function() {
                map.invalidateSize();
            });
        });
    </script>
</body>
</html>
